-- New example script written by wally
-- You can suggest changes with a pull request or something

local repo = 'https://github.com/DeviceHB21/Custom-Liblinoria/tree/main'

local Library = loadstring(game:HttpGet('https://raw.githubusercontent.com/DeviceHB21/Custom-Liblinoria/refs/heads/main/denlib.lua'))()
local ThemeManager = loadstring(game:HttpGet('https://raw.githubusercontent.com/DeviceHB21/Custom-Liblinoria/refs/heads/main/addons/ThemeManager.lua'))()
local SaveManager = loadstring(game:HttpGet('https://raw.githubusercontent.com/DeviceHB21/Custom-Liblinoria/refs/heads/main/addons/SaveManager.lua'))()

local Window = Library:CreateWindow({
    Title = 'NexusVision | Arsenal |v1.3',
    Center = true,
    AutoShow = true,
    TabPadding = 8,
    MenuFadeTime = 0.2
})

local Tabs = {
    Combat = Window:AddTab('Combat'),
    Visuals = Window:AddTab('Visuals'),
    Misc = Window:AddTab('Misc'),
    ['UI Settings'] = Window:AddTab('UI Settings'),
}

local LeftGroupBox = Tabs.Misc:AddLeftGroupbox('Player')

local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local LP = Players.LocalPlayer

-----------------------------------------------------------
--                   ðŸ”¥  NOCLIP
-----------------------------------------------------------

local noclipEnabled = false
local noclipConnection

LeftGroupBox:AddToggle("EnableNoClip", {
    Text = "NoClip",
    Default = false,
    Callback = function(state)
        noclipEnabled = state
        local character = LP.Character or LP.CharacterAdded:Wait()

        if state then
            noclipConnection = RunService.Stepped:Connect(function()
                if not character then return end
                for _, part in ipairs(character:GetDescendants()) do
                    if part:IsA("BasePart") and part.CanCollide then
                        part.CanCollide = false
                    end
                end
            end)
        else
            if noclipConnection then
                noclipConnection:Disconnect()
                noclipConnection = nil
            end

            if character then
                for _, part in ipairs(character:GetDescendants()) do
                    if part:IsA("BasePart") then
                        part.CanCollide = true
                    end
                end
            end
        end
    end
})

    -- No Slowdown
    LeftGroupBox:AddToggle('NoSlowdown_Toggle', {
        Text = 'No Slowdown',
        Default = false,
        Callback = function(Value)
            MovementFlags.NoSlowdown = Value
        end
    })
-----------------------------------------------------------
--                   ðŸ”¥  INFINITE JUMP
-----------------------------------------------------------

local jumpPower = 25
local jumpConnection

LeftGroupBox:AddToggle("EnableInfiniteJump", {
    Text = "Infinite Jump",
    Default = false,
    Callback = function(state)
        if state then
            jumpConnection = UIS.JumpRequest:Connect(function()
                local hum = LP.Character and LP.Character:FindFirstChildOfClass("Humanoid")
                if hum then
                    hum:ChangeState(Enum.HumanoidStateType.Jumping)
                    hum.JumpPower = jumpPower
                end
            end)
        else
            if jumpConnection then
                jumpConnection:Disconnect()
                jumpConnection = nil
            end

            local hum = LP.Character and LP.Character:FindFirstChildOfClass("Humanoid")
            if hum then hum.JumpPower = 50 end
        end
    end
})

LeftGroupBox:AddSlider("InfiniteJumpPower", {
    Text = "Jump Power",
    Default = 25,
    Min = 0,
    Max = 100,
    Rounding = 1,
    Callback = function(v)
        jumpPower = v
        local hum = LP.Character and LP.Character:FindFirstChildOfClass("Humanoid")
        if hum and Toggles.EnableInfiniteJump.Value then
            hum.JumpPower = jumpPower
        end
    end
})

-----------------------------------------------------------
--                   ðŸ”¥  FALL SPEED
-----------------------------------------------------------

local fallSpeedEnabled = false
local fallSpeedValue = 1

LeftGroupBox:AddToggle("EnableFallSpeed", {
    Text = "Fall Speed Control",
    Default = false,
    Callback = function(v)
        fallSpeedEnabled = v
    end
})

LeftGroupBox:AddSlider("FallSpeedSlider", {
    Text = "Fall Speed",
    Default = 1,
    Min = 0,
    Max = 10,
    Rounding = 1,
    Callback = function(v)
        fallSpeedValue = v
    end
})

RunService.Heartbeat:Connect(function()
    if fallSpeedEnabled then
        local hrp = LP.Character and LP.Character:FindFirstChild("HumanoidRootPart")
        if hrp and hrp.Velocity.Y < 0 then
            hrp.Velocity = Vector3.new(hrp.Velocity.X, -fallSpeedValue, hrp.Velocity.Z)
        end
    end
end)

-----------------------------------------------------------
--                   ðŸ”¥  SPEED HACK
-----------------------------------------------------------

local speedValue = 100
local speedConnection

LeftGroupBox:AddToggle("EnableSpeedHack", {
    Text = "Speed Hack",
    Default = false,
    Callback = function(state)
        local hum = LP.Character and LP.Character:FindFirstChildOfClass("Humanoid")
        if not hum then return end

        if state then
            hum.WalkSpeed = speedValue
            speedConnection = hum:GetPropertyChangedSignal("WalkSpeed"):Connect(function()
                if hum.WalkSpeed ~= speedValue then
                    hum.WalkSpeed = speedValue
                end
            end)
        else
            if speedConnection then
                speedConnection:Disconnect()
                speedConnection = nil
            end
            hum.WalkSpeed = 16
        end
    end
})

LeftGroupBox:AddSlider("SpeedHackValue", {
    Text = "Speed Value",
    Default = 100,
    Min = 10,
    Max = 100,
    Rounding = 1,
    Callback = function(v)
        speedValue = v
        local hum = LP.Character and LP.Character:FindFirstChildOfClass("Humanoid")
        if hum and Toggles.EnableSpeedHack.Value then
            hum.WalkSpeed = speedValue
        end
    end
})

-----------------------------------------------------------
--                   ðŸ”¥  JUMP HACK
-----------------------------------------------------------

-----------------------------------------------------------
-- ðŸ” Auto-update R6/R15 on respawn
-----------------------------------------------------------

LP.CharacterAdded:Connect(function(char)
    char:WaitForChild("Humanoid")
    
    -- ÑÐºÑ‰Ð¾ BHOP Ð±ÑƒÐ² ÑƒÐ²Ñ–Ð¼ÐºÐ½ÐµÐ½Ð¸Ð¹ â€” Ð²ÐºÐ»ÑŽÑ‡Ð¸Ñ‚Ð¸ Ð½Ð°Ð·Ð°Ð´
    if bhopEnabled and Toggles.EnableBhopSimple.Value then
        
        local hum = char:WaitForChild("Humanoid")
        hum.WalkSpeed = 16
        
        jumpConnection = hum.Jumping:Connect(function(j)
            table.insert(jumpCount, j)
            hum.WalkSpeed = hum.WalkSpeed + bhopBoost
        end)
    end
end)

task.spawn(function()
    local Players = game:GetService("Players")
    local RunService = game:GetService("RunService")
    local UIS = game:GetService("UserInputService")
    local Workspace = game:GetService("Workspace")

    local LocalPlayer = Players.LocalPlayer

    -- âš™ï¸ Ð¡Ñ‚ÐµÐ¹Ñ‚
    local MovementFlags = {
        AutoJump = false,
        NoFallDamage = false,
        AutoSprint = false,
        WallClimb = false,
        WalkOnWater = false, -- Ñ– Ð²Ð¾Ð´Ð°, Ñ– Ð»Ð°Ð²Ð°
        NoSlowdown = false,
    }

    local SprintSpeed = 24
    local ClimbSpeed = 20

    local CurrentHumanoid
    local RootPart
    local DefaultWalkSpeed = 16
    local DefaultHipHeight = 0

    local lastHealth = nil
    local lastState = nil

    local healthConnection
    local stateConnection

    -- ðŸ§© Ð¾Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ Ð¿Ð¾Ñ‚Ð¾Ñ‡Ð½Ð¾Ð³Ð¾ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð°
    local function SetupCharacter(char)
        if not char then return end

        CurrentHumanoid = char:FindFirstChildOfClass("Humanoid")
        RootPart = char:FindFirstChild("HumanoidRootPart")

        if not CurrentHumanoid or not RootPart then return end

        DefaultWalkSpeed = CurrentHumanoid.WalkSpeed
        DefaultHipHeight = CurrentHumanoid.HipHeight
        lastHealth = CurrentHumanoid.Health

        -- Ð²Ñ–Ð´ÐºÐ»ÑŽÑ‡Ð°Ñ”Ð¼Ð¾ ÑÑ‚Ð°Ñ€Ñ– ÐºÐ¾Ð½ÐµÐºÑ‚Ð¸
        if healthConnection then healthConnection:Disconnect() end
        if stateConnection then stateConnection:Disconnect() end

        -- Ð²Ñ–Ð´ÑÐ»Ñ–Ð´ÐºÐ¾Ð²ÑƒÑ”Ð¼Ð¾ ÑÑ‚ÐµÐ¹Ñ‚ (Freefall/Running Ñ– Ñ‚Ð´)
        stateConnection = CurrentHumanoid.StateChanged:Connect(function(old, new)
            lastState = new
        end)

        -- No Fall Damage Ð¿Ð¾ Humanoid.Health
        healthConnection = CurrentHumanoid.HealthChanged:Connect(function(newHealth)
            if not MovementFlags.NoFallDamage then
                lastHealth = newHealth
                return
            end

            if lastHealth and newHealth < lastHealth then
                -- ÑÐºÑ‰Ð¾ Ð±ÑƒÐ»Ð¾ Ð¿Ð°Ð´Ñ–Ð½Ð½Ñ: Ð¾ÑÑ‚Ð°Ð½Ð½Ñ–Ð¹ ÑÑ‚ÐµÐ¹Ñ‚ Freefall Ð°Ð±Ð¾ FallingDown/Ragdoll
                if lastState == Enum.HumanoidStateType.Freefall
                or lastState == Enum.HumanoidStateType.FallingDown
                or lastState == Enum.HumanoidStateType.Ragdoll then
                    -- Ð¿Ð¾Ð²ÐµÑ€Ñ‚Ð°Ñ”Ð¼Ð¾ Ñ…Ð¿
                    CurrentHumanoid.Health = lastHealth
                    return
                end
            end

            lastHealth = newHealth
        end)
    end

    -- Ð¿Ñ–Ð´Ð¿Ð¸ÑÑƒÑ”Ð¼Ð¾ÑÑŒ Ð½Ð° Ð¿Ð¾Ñ‚Ð¾Ñ‡Ð½Ð¾Ð³Ð¾ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð°
    if LocalPlayer.Character then
        SetupCharacter(LocalPlayer.Character)
    end

    LocalPlayer.CharacterAdded:Connect(function(char)
        char:WaitForChild("Humanoid", 10)
        char:WaitForChild("HumanoidRootPart", 10)
        SetupCharacter(char)
    end)

    ----------------------------------------------------------------
    -- ðŸ” Ð“ÐžÐ›ÐžÐ’ÐÐ˜Ð™ Ð Ð£Ð¥ÐžÐ’Ð˜Ð™ Ð›Ð£ÐŸ (ÑƒÐ½Ñ–Ð²ÐµÑ€ÑÐ°Ð»ÑŒÐ½Ð¸Ð¹)
    ----------------------------------------------------------------
    RunService.RenderStepped:Connect(function(dt)
        if not CurrentHumanoid or not RootPart then return end

        -- ==== AutoSprint + NoSlowdown ====
        local targetSpeed = DefaultWalkSpeed

        if MovementFlags.AutoSprint then
            targetSpeed = SprintSpeed
        end

        if MovementFlags.NoSlowdown then
            -- ÑÐºÑ‰Ð¾ Ð³Ñ€Ð° Ð½Ð°Ð¼Ð°Ð³Ð°Ñ”Ñ‚ÑŒÑÑ ÑƒÑ€Ñ–Ð·Ð°Ñ‚Ð¸ ÑˆÐ²Ð¸Ð´ÐºÑ–ÑÑ‚ÑŒ â€” Ð¿Ð¾Ð²ÐµÑ€Ñ‚Ð°Ñ”Ð¼Ð¾
            if CurrentHumanoid.WalkSpeed < targetSpeed then
                CurrentHumanoid.WalkSpeed = targetSpeed
            end
        else
            -- ÑÐºÑ‰Ð¾ NoSlowdown Ð²Ð¸Ð¼ÐºÐ½ÐµÐ½Ð¾, Ð°Ð»Ðµ AutoSprint ÑƒÐ²Ñ–Ð¼ÐºÐ½ÐµÐ½Ð¾ â€” Ð¿Ñ€Ð¾ÑÑ‚Ð¾ ÑÑ‚Ð°Ð²Ð¸Ð¼Ð¾ ÑÐ¿Ñ€Ð¸Ð½Ñ‚
            if MovementFlags.AutoSprint then
                CurrentHumanoid.WalkSpeed = targetSpeed
            else
                CurrentHumanoid.WalkSpeed = DefaultWalkSpeed
            end
        end

        -- ==== AutoJump ====
        if MovementFlags.AutoJump then
            if CurrentHumanoid.FloorMaterial ~= Enum.Material.Air then
                CurrentHumanoid.Jump = true
            end
        end

        -- ==== Wall Climb ====
        if MovementFlags.WallClimb then
            -- ÑÐºÑ‰Ð¾ Ñ‚Ð¸ Ñ‚Ð¸ÑÐ½ÐµÑˆ W Ñ– Ð²Ð¿Ð¸Ñ€Ð°Ñ”ÑˆÑÑ Ð² ÑÑ‚Ñ–Ð½Ñƒ â€” Ð»Ñ–Ð·ÐµÑˆ Ð²Ð²ÐµÑ€Ñ…
            if UIS:IsKeyDown(Enum.KeyCode.W) then
                local cam = Workspace.CurrentCamera
                local direction = cam.CFrame.LookVector

                local rayParams = RaycastParams.new()
                rayParams.FilterType = Enum.RaycastFilterType.Blacklist
                rayParams.FilterDescendantsInstances = { LocalPlayer.Character }

                local result = Workspace:Raycast(RootPart.Position, direction * 3, rayParams)

                if result and result.Instance and CurrentHumanoid.FloorMaterial == Enum.Material.Air then
                    -- Ð¿Ñ–Ð´Ð½Ñ–Ð¼Ð°Ñ”Ð¼Ð¾ÑÑŒ Ð´Ð¾Ð³Ð¾Ñ€Ð¸
                    RootPart.Velocity = Vector3.new(RootPart.Velocity.X, ClimbSpeed, RootPart.Velocity.Z)
                end
            end
        end

        -- ==== Walk on Water / Lava ====
        if MovementFlags.WalkOnWater then
            local rayParams = RaycastParams.new()
            rayParams.FilterType = Enum.RaycastFilterType.Blacklist
            rayParams.FilterDescendantsInstances = { LocalPlayer.Character }

            -- Ð´Ð¸Ð²Ð¸Ð¼Ð¾ÑÑŒ Ñ‰Ð¾ Ð¿Ñ–Ð´ Ð½Ð°Ð¼Ð¸
            local result = Workspace:Raycast(RootPart.Position, Vector3.new(0, -6, 0), rayParams)

            if result and result.Instance then
                local mat = result.Material
                local name = (result.Instance.Name or ""):lower()

                local isWater = mat == Enum.Material.Water or name:find("water")
                local isLava = name:find("lava")

                if isWater or isLava then
                    -- Ñ‚Ñ€Ð¸Ð¼Ð°Ñ”Ð¼Ð¾ÑÑ Ð½Ð° Ð¿Ð¾Ð²ÐµÑ€Ñ…Ð½Ñ–
                    CurrentHumanoid.HipHeight = 5
                    RootPart.Velocity = Vector3.new(RootPart.Velocity.X, 0, RootPart.Velocity.Z)
                else
                    CurrentHumanoid.HipHeight = DefaultHipHeight
                end
            else
                CurrentHumanoid.HipHeight = DefaultHipHeight
            end
        else
            if CurrentHumanoid.HipHeight ~= DefaultHipHeight then
                CurrentHumanoid.HipHeight = DefaultHipHeight
            end
        end
    end)

    -- Wall Climb
    LeftGroupBox:AddToggle('WallClimb_Toggle', {
        Text = 'Wall Climb',
        Default = false,
        Callback = function(Value)
            MovementFlags.WallClimb = Value
        end
    })

    LeftGroupBox:AddSlider('ClimbSpeed_Slider', {
        Text = 'Climb Speed',
        Default = 20,
        Min = 5,
        Max = 60,
        Rounding = 0,
        Callback = function(Value)
            ClimbSpeed = Value
        end
    })
end)

    local WVRWRE = Tabs.Misc:AddRightGroupbox("Camera Settings")
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UIS = game:GetService("UserInputService")
local Camera = workspace.CurrentCamera
local LP = Players.LocalPlayer

local CamSettings = {
    ShakeRemove      = false,
    ForceFirstPerson = false,
    NoCollision      = false,

    EnableFOV        = false,
    FOV              = 70,

    EnableCamSpeed   = false,
    CamSpeed         = 1,

    EnableCustomSens = false,
    CustomSens       = 1
}

--------------------------------------------------------
-- ðŸ”¥ SHAKE REMOVE
--------------------------------------------------------
local function RemoveShake()
    for _, v in pairs(Camera:GetDescendants()) do
        if v:IsA("NumberValue") or v:IsA("Vector3Value") then
            v.Value = 0
        end
    end
end

--------------------------------------------------------
-- ðŸ”¥ FIXED NO CAMERA COLLISION (2025)
--------------------------------------------------------
local function NoCamClipLoop()
    if not CamSettings.NoCollision then return end

    local head = LP.Character and LP.Character:FindFirstChild("Head")
    if not head then return end

    local camPos = Camera.CFrame.Position
    local dir = (camPos - head.Position)

    local ray = Ray.new(head.Position, dir)
    local hit, pos = workspace:FindPartOnRay(ray, LP.Character)

    if hit then
        Camera.CFrame = CFrame.new(pos)
    end
end

RunService.RenderStepped:Connect(NoCamClipLoop)

--------------------------------------------------------
-- ðŸ”¥ CAMERA UPDATE LOOP
--------------------------------------------------------
RunService.RenderStepped:Connect(function()

    -- Shake Remove
    if CamSettings.ShakeRemove then
        RemoveShake()
    end

    -- First Person
    if CamSettings.ForceFirstPerson and LP.Character and LP.Character:FindFirstChild("Head") then
        Camera.CFrame = CFrame.new(Camera.CFrame.Position, LP.Character.Head.Position)
    end

    -- FOV
    if CamSettings.EnableFOV then
        Camera.FieldOfView = CamSettings.FOV
    end

end)

--------------------------------------------------------
-- ðŸŽ› CUSTOM SENSITIVITY + CAMERA SPEED
--------------------------------------------------------
UIS.InputChanged:Connect(function(i)
    if i.UserInputType == Enum.UserInputType.MouseMovement then
        
        if CamSettings.EnableCustomSens then
            local sens = CamSettings.CustomSens
            local spd = CamSettings.CamSpeed

            Camera.CFrame *= CFrame.Angles(
                -i.Delta.Y * 0.002 * sens * spd,
                -i.Delta.X * 0.002 * sens * spd,
                0
            )
        end
    end
end)

--------------------------------------------------------
-- ðŸŸ¦ UI CONNECTIONS
--------------------------------------------------------

-- Shake Remove
WVRWRE:AddToggle("ShakeRemove", {
    Text = "Shake Remove",
    Default = false,
    Callback = function(v)
        CamSettings.ShakeRemove = v
    end
})

-----------------------------------
-- ðŸ”¥ Camera Speed Toggle + Slider
-----------------------------------
WVRWRE:AddToggle("EnableCamSpeed", {
    Text = "Enable Camera Speed",
    Default = false,
    Callback = function(v)
        CamSettings.EnableCamSpeed = v
    end
})

WVRWRE:AddSlider("CamSpeed", {
    Text = "Camera Speed",
    Default = 1,
    Min = 0.1,
    Max = 5,
    Rounding = 1,
    Callback = function(v)
        CamSettings.CamSpeed = v
    end
})

-----------------------------------
-- ðŸ”¥ Custom Sensitivity Toggle + Slider
-----------------------------------
WVRWRE:AddToggle("EnableCustomSens", {
    Text = "Enable Custom Sens",
    Default = false,
    Callback = function(v)
        CamSettings.EnableCustomSens = v
    end
})

WVRWRE:AddSlider("CustomSens", {
    Text = "Custom Sensitivity",
    Default = 1,
    Min = 0.1,
    Max = 5,
    Rounding = 1,
    Callback = function(v)
        CamSettings.CustomSens = v
    end
})

    local Anti = Tabs.Misc:AddRightGroupbox("Anti Aim")

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

local LP = Players.LocalPlayer
local Char = LP.Character or LP.CharacterAdded:Wait()
local HRP = Char:WaitForChild("HumanoidRootPart")
local Hum = Char:WaitForChild("Humanoid")

-- ===========================
-- ðŸ”¥ ANTI AIM VARIABLES
-- ===========================
local AntiAim_Toggle = false
local NoAnims_Toggle = false

local Pitch_Type = "Custom"
local CustomPitch_Value = 0

local Yaw_Type = "Custom"
local CustomYaw_Value = 0

local AntiAim_Speed = 0
local backrotation = CFrame.new(0, 0, 0)

-- ===========================
-- ðŸ”¥ Ð¤Ð£ÐÐšÐ¦Ð†Ð¯ Ð’Ð¡Ð¢ÐÐÐžÐ’Ð›Ð•ÐÐÐ¯ ÐŸÐžÐ’ÐžÐ ÐžÐ¢Ð£
-- ===========================
local function SetRotation(yaw, pitch)
    if not HRP then return end

    HRP.CFrame = CFrame.new(HRP.Position) *
        CFrame.Angles(math.rad(pitch), math.rad(yaw), 0)
end

-- ===========================
-- ðŸ”¥ ANTI AIM CORE
-- ===========================
local jitterState = false

local function ApplyAntiAim()
    if not AntiAim_Toggle then return end
    if not HRP then return end

    Hum.AutoRotate = false

    local yaw = 0
    local pitch = 0

    -- ========== PITCH ==========
    if Pitch_Type == "Custom" then
        pitch = CustomPitch_Value
    end

    -- ========== YAW ==========

    if Yaw_Type == "Custom" then
        yaw = CustomYaw_Value

    elseif Yaw_Type == "Jitter" then
        jitterState = not jitterState
        yaw = jitterState and -180 or 180

    elseif Yaw_Type == "Spin" then
        yaw = tick() * AntiAim_Speed * 25 % 360

    elseif Yaw_Type == "Back" then
        yaw = (workspace.CurrentCamera.CFrame.LookVector * Vector3.new(1,0,1)).Unit
        yaw = workspace.CurrentCamera.CFrame.Y + 180
    end

    SetRotation(yaw, pitch)
end

-- ===========================
-- âŒ DISABLE ANIMATIONS
-- ===========================
RunService.Stepped:Connect(function()
    if NoAnims_Toggle and Hum then
        
        -- ðŸ”¹ Ð’Ð¸Ð¼ÐºÐ½ÑƒÑ‚Ð¸ AutoRotate (Ñ€ÐµÐ°Ð»Ñ–ÑÑ‚Ð¸Ñ‡Ð½Ð¾)
        Hum.AutoRotate = false

        -- ðŸ”¹ Ð’Ð¸Ð¼ÐºÐ½ÑƒÑ‚Ð¸ Animator (core solution)
        local animator = Hum:FindFirstChildOfClass("Animator")
        if animator then
            animator:Destroy()
        end

        -- ðŸ”¹ Ð—ÑƒÐ¿Ð¸Ð½Ð¸Ñ‚Ð¸ Ð²ÑÑ– Ð°Ð½Ñ–Ð¼Ð°Ñ†Ñ–Ñ—
        for _, track in ipairs(Hum:GetPlayingAnimationTracks()) do
            track:Stop()
        end
    end
end)


-- ===========================
-- ðŸ” UPDATE LOOP
-- ===========================
RunService.Heartbeat:Connect(ApplyAntiAim)

-----------------------------------------------------------
--                   FLUENT UI
-----------------------------------------------------------

Anti:AddToggle("AntiAimToggle", {
    Text = "Anti Aim",
    Default = false,
    Callback = function(v)
        AntiAim_Toggle = v
        Hum.AutoRotate = not v
    end
})

Anti:AddToggle("DisableAnimations", {
    Text = "Disable Animations",
    Default = false,
    Callback = function(v)
        NoAnims_Toggle = v
    end
})

Anti:AddDropdown("YawDropdown", {
    Text = "Yaw Type",
    Values = {"Custom", "Jitter", "Spin", "Back"},
    Default = "Custom",
    Callback = function(v)
        Yaw_Type = v
    end
})

Anti:AddSlider("YawSlider", {
    Text = "Yaw Value",
    Min = 0,
    Max = 360,
    Default = 0,
    Rounding = 1,
    Callback = function(v)
        CustomYaw_Value = v
    end
})

Anti:AddSlider("SpinSpeedSlider", {
    Text = "Spin Speed",
    Min = 0,
    Max = 100,
    Default = 0,
    Rounding = 1,
    Callback = function(v)
        AntiAim_Speed = v
    end
})

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")
local Camera = Workspace.CurrentCamera
local UIS = game:GetService("UserInputService")

local LP = Players.LocalPlayer

-- ================== VARIABLES ==================
local aimbotEnabled = false
local holding = false
local teamCheck = false
local visibilityCheck = false
local predictionEnabled = false
local predictionStrength = 1
local predictionSmoothness = 5

local smoothingFactor = 0.5
local FOVRadius = 150
local FovEnabled = false
local FovUse = false
local FovFill = false
local FovDynamic = false
local FovOutline = true
local FovColor = Color3.fromRGB(0, 255, 0)
local FovShape = 100
local FovThickness = 2

local TargetType = "Closest To Mouse"
local TargetHitbox = "Head"
local speed = 2200

-- ðŸ”µ FOV CIRCLE Ð— Ð Ð•ÐÐ›Ð¬ÐÐ˜Ðœ OUTLINE
local mainCircle = Drawing.new("Circle")
mainCircle.Thickness = FovThickness
mainCircle.NumSides = FovShape
mainCircle.Filled = FovFill
mainCircle.Transparency = 0.1
mainCircle.Color = FovColor
mainCircle.Visible = false

local outlineCircle = Drawing.new("Circle")
outlineCircle.Thickness = FovThickness + 2
outlineCircle.NumSides = FovShape
outlineCircle.Filled = false
outlineCircle.Color = Color3.fromRGB(0, 0, 0)
outlineCircle.Visible = false

-- ================== FUNCTIONS ==================
local function isVisible(target)
    local origin = Camera.CFrame.Position
    local direction = (target.Position - origin)
    local ray = RaycastParams.new()
    ray.FilterType = Enum.RaycastFilterType.Blacklist
    ray.FilterDescendantsInstances = {LP.Character, Workspace.CurrentCamera}
    local result = Workspace:Raycast(origin, direction, ray)
    return result == nil
end

local function is_in_fov(screen_pos)
    local screenCenter = Vector2.new(Camera.ViewportSize.X / 2, Camera.ViewportSize.Y / 2)
    return (screenCenter - Vector2.new(screen_pos.X, screen_pos.Y)).Magnitude <= FOVRadius
end

local function getTargetPart(character)
    if not character then return nil end
    local part = character:FindFirstChild(TargetHitbox)
    if part and part:IsA("BasePart") then
        return part
    end
    return nil
end

local function predict(pos, vel)
    local dist = (pos - Camera.CFrame.Position).Magnitude
    if dist < 1 then return pos end
    local time = dist / speed
    local predicted = pos + (vel * time * predictionStrength)
    return predicted + Vector3.new(0, 50 * time^2 / predictionSmoothness, 0)
end

local function getClosestPlayer()
    local closestDist = math.huge
    local targetPlayer = nil
    local viewportSize = Camera.ViewportSize
    local screenCenter = Vector2.new(viewportSize.X / 2, viewportSize.Y / 2)

    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LP and player.Character and player.Character:FindFirstChild("Humanoid") and player.Character.Humanoid.Health > 0 then
            if teamCheck and player.Team == LP.Team then continue end

            local part = getTargetPart(player.Character)
            if part then
                local screenPos, onScreen = Camera:WorldToViewportPoint(part.Position)
                if onScreen and screenPos.Z > 0 and is_in_fov(screenPos) then
                    if visibilityCheck and not isVisible(part) then continue end

                    local dist
                    if TargetType == "Closest To Mouse" then
                        dist = (Vector2.new(screenPos.X, screenPos.Y) - screenCenter).Magnitude
                    elseif TargetType == "Closest To Player" then
                        dist = (player.Character.HumanoidRootPart.Position - LP.Character.HumanoidRootPart.Position).Magnitude
                    end

                    if dist < closestDist then
                        closestDist = dist
                        targetPlayer = player
                    end
                end
            end
        end
    end
    return targetPlayer
end

local function moveMouseTowards(targetPos)
    local screenCenter = Vector2.new(Camera.ViewportSize.X / 2, Camera.ViewportSize.Y / 2)
    local dx = targetPos.X - screenCenter.X
    local dy = targetPos.Y - screenCenter.Y
    local moveX = dx * smoothingFactor
    local moveY = dy * smoothingFactor
    if mousemoverel then
        mousemoverel(moveX, moveY)
    end
end

-- ================== INPUT ==================
UIS.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton2 then
        holding = true
    end
end)

UIS.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton2 then
        holding = false
    end
end)

-- ================== Ð’Ð†Ð”ÐœÐÐ›Ð¬ÐžÐ’ÐšÐ ==================
RunService.RenderStepped:Connect(function()
    if FovEnabled then
        local center = Vector2.new(Camera.ViewportSize.X / 2, Camera.ViewportSize.Y / 2)
        local radius = FOVRadius
        if FovDynamic and holding then
            radius = FOVRadius * 0.85
        end

        -- ðŸŸ¢ ÐžÑÐ½Ð¾Ð²Ð½Ðµ ÐºÐ¾Ð»Ð¾
        mainCircle.Position = center
        mainCircle.Radius = radius
        mainCircle.Color = FovColor
        mainCircle.NumSides = FovShape
        mainCircle.Thickness = FovThickness
        mainCircle.Filled = FovFill
        mainCircle.Visible = true
        mainCircle.Transparency = 0.5

        -- âš« ÐÐºÑƒÑ€Ð°Ñ‚Ð½Ð¸Ð¹ outline (Ð·Ð·Ð°Ð´Ñƒ)
        if FovOutline then
            outlineCircle.Position = center
            outlineCircle.Radius = radius
            outlineCircle.Color = Color3.fromRGB(0, 0, 0)
            outlineCircle.NumSides = FovShape
            outlineCircle.Thickness = FovThickness + 2
            outlineCircle.Filled = false
            outlineCircle.Visible = true
            outlineCircle.ZIndex = -1 -- ðŸ’¡ Ñ†Ðµ Ñ‚Ñ€Ð¸Ð¼Ð°Ñ” outline Ð¿Ð¾Ð·Ð°Ð´Ñƒ
        else
            outlineCircle.Visible = false
        end
    else
        mainCircle.Visible = false
        outlineCircle.Visible = false
    end
    -- Aimbot logic
    if aimbotEnabled and holding then
        local target = getClosestPlayer()
        if target and target.Character then
            local part = getTargetPart(target.Character)
            if part then
                local futurePos = predictionEnabled and predict(part.Position, part.Velocity or Vector3.new()) or part.Position
                local screenPos, onScreen = Camera:WorldToViewportPoint(futurePos)
                if onScreen and screenPos.Z > 0 then
                    moveMouseTowards(Vector2.new(screenPos.X, screenPos.Y))
                end
            end
        end
    end
end)
-- ===================== AIMBOT =====================
local Aim = Tabs.Combat:AddLeftGroupbox('Aim Bot')

Aim:AddToggle("EnableAimbot", {
    Text = "Enable Aimbot",
    Default = false,
    Callback = function(v)
        aimbotEnabled = v
    end
})

Aim:AddToggle("TeamCheck", {
    Text = "Team Check",
    Default = false,
    Callback = function(v)
        teamCheck = v
    end
})

Aim:AddToggle("PredictionToggle", {
    Text = "Prediction",
    Default = false,
    Callback = function(v)
        predictionEnabled = v
    end
})

Aim:AddSlider("PredictionStrength", {
    Text = "Prediction Strength",
    Min = 0.1, Max = 3,
    Rounding = 1,
    Default = 1,
    Callback = function(v)
        predictionStrength = v
    end
})

Aim:AddSlider("PredictionStrength", {
    Text = "Prediction Smoothness",
    Min = 0, Max = 10,
    Rounding = 1,
    Default = 5,
    Callback = function(v)
        predictionSmoothness = v
    end
})

Aim:AddSlider("AimbotSensitivity", {
    Text = "Sensitivity",
    Min = 0.1, Max = 2,
    Rounding = 1,
    Default = 0.5,
    Callback = function(v)
        smoothingFactor = v
    end
})

Aim:AddDropdown("TargetType", {
    Text = "Target Type",
    Values = {"Closest To Mouse", "Closest To Player"},
    Default = "Closest To Mouse",
    Callback = function(v)
        TargetType = v
    end
})

Aim:AddDropdown("TargetHitbox", {
    Text = "Target Hitbox",
    Values = {"Head", "HumanoidRootPart"},
    Default = "Head",
    Callback = function(v)
        TargetHitbox = v
    end
})

local Fov = Tabs.Combat:AddRightGroupbox('Aim Bot')

Fov:AddToggle("EnableFOV", {
    Text = "Enable FOV",
    Default = false,
    Callback = function(v)
        FovEnabled = v
    end
})

Fov:AddToggle("UseFOV", {
    Text = "Use Field Of View",
    Default = true,
    Callback = function(v)
        FovUse = v
    end
}):AddColorPicker("FOVColor", {
    Default = Color3.fromRGB(0,255,0),
    Transparency = 0,
    Callback = function(color)
        FovColor = color
    end
})

Fov:AddToggle("CircleOutline", {
    Text = "Circle Outline",
    Default = true,
    Callback = function(v)
        FovOutline = v
    end
})

Fov:AddToggle("FillCircle", {
    Text = "Fill Circle",
    Default = false,
    Callback = function(v)
        FovFill = v
    end
})

Fov:AddToggle("DynamicFOV", {
    Text = "Dynamic Circle",
    Default = false,
    Callback = function(v)
        FovDynamic = v
    end
})

Fov:AddSlider("Field Of ViewÐ²", {
    Text = "Field Of View",
    Min = 50, Max = 400,
    Rounding = 1,
    Default = 150,
    Callback = function(v)
        FOVRadius = v
    end
})

Fov:AddSlider("FOVShape", {
    Text = "Circle Shape",
    Min = 1, Max = 100,
    Rounding = 1,
    Default = 100,
    Callback = function(v)
        FovShape = v
    end
})

Fov:AddSlider("FOVThickness", {
    Text = "Circle Thickness",
    Min = 1, Max = 5,
    Rounding = 1,
    Default = 2,
    Callback = function(v)
        FovThickness = v
    end
})

local Gun = Tabs.Combat:AddLeftGroupbox('Gun Mods')

local recoilValue = 0
local recoilEnabled = false
local fireRateEnabled = false
local fireRateValue = 1

local RepStorage = game:GetService("ReplicatedStorage")
local WeaponsFolder = RepStorage:WaitForChild("Weapons")

-- ===========================================
-- ðŸŸ¦ RECOIL CONTROL â€” Ð¢ÐžÐ“Ð› + Ð¡Ð›ÐÐ™Ð”Ð•Ð 
-- ===========================================

Gun:AddToggle('recoil_toggle', {
    Text = 'Recoil Control',
    Default = false,
    Tooltip = 'Ð’Ð¸Ð¼Ð¸ÐºÐ°Ñ” Ð²Ñ–Ð´Ð´Ð°Ñ‡Ñƒ Ñ‚Ð° Ñ€Ð¾Ð·ÐºÐ¸Ð´',
    Callback = function(state)
        recoilEnabled = state

        for _, v in pairs(WeaponsFolder:GetDescendants()) do
            if v.Name == "RecoilControl" or v.Name == "MaxSpread" then
                if state then
                    v.Value = recoilValue
                else
                    v.Value = 100
                end
            end
        end
    end
})

Gun:AddSlider('recoil_slider', {
    Text = 'Recoil Value',
    Default = 0,
    Min = 0,
    Max = 10,
    Rounding = 1,

    Callback = function(value)
        recoilValue = value
        if recoilEnabled then
            for _, v in pairs(WeaponsFolder:GetDescendants()) do
                if v.Name == "RecoilControl" or v.Name == "MaxSpread" then
                    v.Value = recoilValue
                end
            end
        end
    end
})

-- ===========================================
-- ðŸ”¥ FIRE RATE â€” Ð¢ÐžÐ“Ð› + Ð¡Ð›ÐÐ™Ð”Ð•Ð 
-- ===========================================

Gun:AddToggle('firerate_toggle', {
    Text = 'Fire Rate Modifier',
    Default = false,
    Tooltip = 'Ð—Ð±Ñ–Ð»ÑŒÑˆÑƒÑ” ÑˆÐ²Ð¸Ð´ÐºÑ–ÑÑ‚ÑŒ ÑÑ‚Ñ€Ñ–Ð»ÑŒÐ±Ð¸',
    Callback = function(state)
        fireRateEnabled = state

        for _, v in pairs(WeaponsFolder:GetDescendants()) do

            if v.Name == "Auto" then
                v.Value = state
            end

            if v.Name == "FireRate" then
                local rate = 0.1 - ((fireRateValue - 1) * 0.0009)
                v.Value = state and rate or 0.1
            end
        end
    end
})

Gun:AddSlider('firerate_slider', {
    Text = 'Fire Rate Power',
    Default = 1,
    Min = 1,
    Max = 100,
    Rounding = 1,

    Callback = function(value)
        fireRateValue = value

        if fireRateEnabled then
            for _, v in pairs(WeaponsFolder:GetDescendants()) do
                if v.Name == "FireRate" then
                    local rate = 0.1 - ((value - 1) * 0.0009)
                    v.Value = rate
                end
            end
        end
    end
})

task.spawn(function()
    local Players = game:GetService("Players")
    local LocalPlayer = Players.LocalPlayer

    -- ðŸ§© Ð—Ð¼Ñ–Ð½Ð½Ñ–
    local ExpansionSize = Vector3.new(3, 3, 3)
    local Transparency = 0.5
    local OriginalSizes = {}
    local HeadExpandEnabled = false
    local Connections = {}

    -- ðŸ”¹ Ð Ð¾Ð·ÑˆÐ¸Ñ€ÑŽÑ” Ð³Ð¾Ð»Ð¾Ð²Ñƒ
    local function expandHead(char)
        if char.Parent == LocalPlayer then return end
        local head = char:FindFirstChild("Head")
        if head and head:IsA("BasePart") then
            if not OriginalSizes[head] then
                OriginalSizes[head] = head.Size
            end
            head.Size = ExpansionSize
            head.Transparency = Transparency
            head.Material = Enum.Material.Neon
        end
    end

    -- ðŸ”¹ Ð”Ð»Ñ Ð½Ð¾Ð²Ð¾Ð³Ð¾ Ð³Ñ€Ð°Ð²Ñ†Ñ
    local function onPlayer(plr)
        if plr == LocalPlayer then return end
        if plr.Character then expandHead(plr.Character) end
        plr.CharacterAdded:Connect(function(char)
            char:WaitForChild("Head")
            expandHead(char)
        end)
    end

    -- ðŸ”¹ Ð£Ð²Ñ–Ð¼ÐºÐ½ÐµÐ½Ð½Ñ
    local function enableExpander()
        for _, plr in ipairs(Players:GetPlayers()) do
            onPlayer(plr)
        end
        Connections["PlayerAdded"] = Players.PlayerAdded:Connect(onPlayer)
    end

    -- ðŸ”¹ Ð’Ð¸Ð¼ÐºÐ½ÐµÐ½Ð½Ñ
    local function disableExpander()
        if Connections["PlayerAdded"] then
            Connections["PlayerAdded"]:Disconnect()
            Connections["PlayerAdded"] = nil
        end
        for head, size in pairs(OriginalSizes) do
            if head and head.Parent then
                head.Size = size
                head.Transparency = 0
                head.Material = Enum.Material.Plastic
            end
        end
    end
    --------------------------------------------------------------------
    -- ðŸ§  FLUENT RENEWED UI (HEAD EXPANDER)
    --------------------------------------------------------------------
local HeadExpander = Tabs.Combat:AddRightGroupbox('Head Expander')

    -- ðŸŸ¢ Toggle
    HeadExpander:AddToggle('HeadExpand_Toggle', {
        Text = 'Enable Head Expander',
        Default = false,
        Callback = function(Value)
            HeadExpandEnabled = Value
            if Value then
                enableExpander()
            else
                disableExpander()
            end
        end
    })

    -- ðŸŽšï¸ Slider: Head Size
    HeadExpander:AddSlider('HeadSize_Slider', {
        Text = 'Head Size',
        Min = 2,
        Max = 6,
        Default = 3,
        Rounding = 1,
        Callback = function(v)
            ExpansionSize = Vector3.new(v, v, v)
            if HeadExpandEnabled then
                for _, plr in ipairs(Players:GetPlayers()) do
                    if plr ~= LocalPlayer and plr.Character and plr.Character:FindFirstChild("Head") then
                        expandHead(plr.Character)
                    end
                end
            end
        end
    })

    -- ðŸŽšï¸ Slider: Transparency
    HeadExpander:AddSlider('HeadTransparency_Slider', {
        Text = 'Head Transparency',
        Min = 0,
        Max = 1,
        Default = 0.5,
        Rounding = 1,
        Callback = function(v)
            Transparency = v
            if HeadExpandEnabled then
                for _, plr in ipairs(Players:GetPlayers()) do
                    if plr ~= LocalPlayer and plr.Character and plr.Character:FindFirstChild("Head") then
                        expandHead(plr.Character)
                    end
                end
            end
        end
    })


    --------------------------------------------------------------------
    -- ðŸ›¡ï¸ ÐœÐ°ÑÐºÑƒÐ²Ð°Ð½Ð½Ñ Ñ€Ð¾Ð·Ð¼Ñ–Ñ€Ñƒ (Ð°Ð½Ñ‚Ð¸Ñ‡Ð¸Ñ‚)
    --------------------------------------------------------------------
    local mt = getrawmetatable(game)
    setreadonly(mt, false)

    local oldIndex = mt.__index
    local oldNamecall = mt.__namecall

    mt.__index = newcclosure(function(self, key)
        if key == "Size" and OriginalSizes[self] then
            return OriginalSizes[self]
        end
        return oldIndex(self, key)
    end)

    mt.__namecall = newcclosure(function(self, ...)
        local method = getnamecallmethod()
        local args = {...}

        if method == "Size" and OriginalSizes[self] then
            return OriginalSizes[self]
        end

        return oldNamecall(self, unpack(args))
    end)

    setreadonly(mt, true)
end)

local LeftGroupBox = Tabs.Visuals:AddLeftGroupbox('Player Esp')

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera

-- ðŸ§  FLAGS & SETTINGS
local flags = {}
local settings = {
    maxHPVisibility = 100,
    boxType = "Boxes",       -- Boxes / Corners
    boxRender = "Dynamic",   -- Dynamic / Static
    metric = "Meters",       -- Meters / Studs
    useDisplayName = true
}

-- ðŸ”° ESP Ð“ÐžÐ›ÐžÐ’ÐÐ† ÐŸÐ•Ð Ð•ÐœÐ˜ÐšÐÐ§Ð†
LeftGroupBox:AddToggle('enable esp', {
    Text = 'Enable ESP',
    Default = false,
    Callback = function(Value)
        flags["enable esp"] = Value
    end
})

LeftGroupBox:AddToggle('box', {
    Text = 'Box',
    Default = false,
    Callback = function(Value)
        flags["box"] = Value
    end
})
:AddColorPicker('color box', {
    Default = Color3.new(1, 1, 1),
    Title = 'Box Color',
    Callback = function(Value)
        flags["color box"] = Value
    end
})

-- â¤ï¸ Health Bar
LeftGroupBox:AddToggle('box bar', {
    Text = 'Health Bar',
    Default = false,
    Callback = function(Value)
        flags["box bar"] = Value
    end
})
:AddColorPicker('color hp full', {
    Default = Color3.fromRGB(255, 255, 255),
    Title = 'Full Health Color',
    Callback = function(Value)
        flags["color hp full"] = Value
    end
})
:AddColorPicker('color hp low', {
    Default = Color3.fromRGB(255, 255, 255),
    Title = 'Low Health Color',
    Callback = function(Value)
        flags["color hp low"] = Value
    end
})

LeftGroupBox:AddToggle('box number hear', {
    Text = 'Health Number',
    Default = false,
    Callback = function(Value)
        flags["box number hear"] = Value
    end
})

-- ðŸ§â€â™‚ï¸ Name
-- ðŸ§â€â™‚ï¸ Name (Ð· Ð²Ð»Ð°ÑÐ½Ð¸Ð¼ ÐºÐ¾Ð»ÑŒÐ¾Ñ€Ð¾Ð¼)
LeftGroupBox:AddToggle('box name', {
    Text = 'Show Name',
    Default = false,
    Callback = function(Value)
        flags["box name"] = Value
    end
})
:AddColorPicker('color name', {
    Default = Color3.new(1, 1, 1),
    Title = 'Name Color',
    Callback = function(Value)
        flags["color name"] = Value
    end
})

-- ðŸ“ Distance
LeftGroupBox:AddToggle('box discr', {
    Text = 'Distance',
    Default = false,
    Callback = function(Value)
        flags["box discr"] = Value
    end
})
:AddColorPicker('distance', {
    Default = Color3.new(1, 1, 1),
    Title = 'Distance Color',
    Callback = function(Value)
        flags["distance"] = Value
    end
})

-- ðŸ”« Equipped Item
LeftGroupBox:AddToggle('box item', {
    Text = 'Equipped Item',
    Default = false,
    Callback = function(Value)
        flags["box item"] = Value
    end
})
:AddColorPicker('color item', {
    Default = Color3.new(1, 1, 1),
    Title = 'Item Color',
    Callback = function(Value)
        flags["color item"] = Value
    end
})

-- ðŸ“ Tracer
LeftGroupBox:AddToggle('tbox', {
    Text = 'Tracer',
    Default = false,
    Callback = function(Value)
        flags["tbox"] = Value
    end
})
:AddColorPicker('color tracer', {
    Default = Color3.new(1, 1, 1),
    Title = 'Tracer Color',
    Callback = function(Value)
        flags["color tracer"] = Value
    end
})

-- ðŸŽšï¸ Distance Check Slider
LeftGroupBox:AddSlider('dis chek', {
    Text = "Distance Check",
    Min = 1000,
    Max = 10000,
    Default = 5000,
    Rounding = 1,
    Callback = function(Value)
        flags["dis chek"] = Value
    end
})

local LeftGroupBox = Tabs.Visuals:AddLeftGroupbox('Esp Settings')

LeftGroupBox:AddSlider('max hp visibility', {
    Text = "Max HP Visibility",
    Min = 0,
    Max = 100,
    Default = 100,
    Rounding = 1,
    Callback = function(Value)
        settings.maxHPVisibility = Value
    end
})

LeftGroupBox:AddDropdown('box render', {
    Text = "Box Render",
    Values = {"Dynamic", "Static"},
    Default = "Dynamic",
    Callback = function(Value)
        settings.boxRender = Value
    end
})

LeftGroupBox:AddDropdown('metric', {
    Text = "Metric",
    Values = {"Meters", "Studs"},
    Default = "Meters",
    Callback = function(Value)
        settings.metric = Value
    end
})

LeftGroupBox:AddDropdown('box type', {
    Text = "Box Type",
    Values = {"Boxes", "Corners"},
    Default = "Boxes",
    Callback = function(Value)
        settings.boxType = Value
    end
})

LeftGroupBox:AddToggle('use display name', {
    Text = 'Use Display Name',
    Default = true,
    Callback = function(Value)
        settings.useDisplayName = Value
    end
})

-- === CREATE ESP OBJECT ===
local function CreateESP()
    local esp = {}

    esp.BoxOutline = Drawing.new("Square")
    esp.BoxOutline.Visible = false
    esp.BoxOutline.Color = Color3.new(0,0,0)
    esp.BoxOutline.Thickness = 2

    esp.Box = Drawing.new("Square")
    esp.Box.Visible = false
    esp.Box.Color = Color3.new(1,1,1)
    esp.Box.Thickness = 1

    esp.CornerLines = {}
    for i = 1, 8 do
        local line = Drawing.new("Line")
        line.Visible = false
        table.insert(esp.CornerLines, line)
    end

    esp.HealthBarOutline = Drawing.new("Square")
    esp.HealthBarOutline.Visible = false
    esp.HealthBarOutline.Color = Color3.new(0,0,0)
    esp.HealthBarOutline.Thickness = 4

    esp.HealthBar = Drawing.new("Square")
    esp.HealthBar.Visible = false
    esp.HealthBar.Thickness = 2

    esp.NameText = Drawing.new("Text")
    esp.NameText.Visible = false
    esp.NameText.Outline = true
    esp.NameText.Center = true
    esp.NameText.Size = 15
    esp.NameText.Font = 0 

    esp.DistanceText = Drawing.new("Text")
    esp.DistanceText.Visible = false
    esp.DistanceText.Outline = true
    esp.DistanceText.Center = true
    esp.DistanceText.Size = 14
    esp.DistanceText.Font = 0

    esp.HealthPercentText = Drawing.new("Text")
    esp.HealthPercentText.Visible = false
    esp.HealthPercentText.Outline = true
    esp.HealthPercentText.Center = true
    esp.HealthPercentText.Size = 14
    esp.HealthPercentText.Font = 0

    esp.TracerLine = Drawing.new("Line")
    esp.TracerLine.Visible = false
    esp.TracerLine.Thickness = 1

    esp.ItemText = Drawing.new("Text")
    esp.ItemText.Visible = false
    esp.ItemText.Outline = true
    esp.ItemText.Center = true
    esp.ItemText.Size = 14
    esp.ItemText.Font = 0

    return esp
end

-- === ESP HANDLERS ===
local ESPTable = {}

local function RemoveESP(player)
    if ESPTable[player] then
        for _, v in pairs(ESPTable[player]) do
            if typeof(v) == "table" then
                for _, line in ipairs(v) do pcall(line.Remove, line) end
            else
                pcall(v.Remove, v)
            end
        end
        ESPTable[player] = nil
    end
end

local function AddESP(player)
    if player ~= LocalPlayer and not ESPTable[player] then
        ESPTable[player] = CreateESP()
    end
end

for _, p in ipairs(Players:GetPlayers()) do AddESP(p) end
Players.PlayerAdded:Connect(AddESP)
Players.PlayerRemoving:Connect(RemoveESP)

-- === MAIN RENDER LOOP ===
RunService.RenderStepped:Connect(function()
    if not flags["enable esp"] then
        for _, esp in pairs(ESPTable) do
            for _, v in pairs(esp) do
                if typeof(v) == "table" then
                    for _, l in ipairs(v) do l.Visible = false end
                else
                    v.Visible = false
                end
            end
        end
        return
    end

    local camPos = Camera.CFrame.Position
    local maxDistance = flags["dis chek"] or 10000
    local viewSize = Camera.ViewportSize
    local screenCenter = Vector2.new(viewSize.X/2, viewSize.Y)

    for player, esp in pairs(ESPTable) do
        local char = player.Character
        local hrp = char and char:FindFirstChild("HumanoidRootPart")
        local hum = char and char:FindFirstChildOfClass("Humanoid")

        if hrp and hum and hum.Health > 0 then
            local pos, onScreen = Camera:WorldToViewportPoint(hrp.Position)
            local distance = (camPos - hrp.Position).Magnitude

            if not onScreen or distance > maxDistance then
                for _, v in pairs(esp) do
                    if typeof(v) == "table" then
                        for _, l in ipairs(v) do l.Visible = false end
                    else
                        v.Visible = false
                    end
                end
                continue
            end

            local boxWidth, boxHeight = 40, 60
            if settings.boxRender == "Dynamic" then
                local scale = math.clamp(100 / distance, 0, 300)
                boxWidth, boxHeight = 40*scale, 60*scale
            end

            local xPos, yPos = pos.X - boxWidth/2, pos.Y - boxHeight/2

            local boxEnabled    = flags["box"]
            local barEnabled    = flags["box bar"]
            local nameEnabled   = flags["box name"]
            local discrEnabled  = flags["box discr"]
            local numberEnabled = flags["box number hear"]
            local itemEnabled   = flags["box item"]

            local boxColor      = flags["color box"] or Color3.new(1,1,1)
            local tracerColor   = flags["color tracer"] or Color3.new(1,1,1)
            local discrColor    = flags["distance"] or Color3.new(1,1,1)
            local itemColor     = flags["color item"] or Color3.new(1,1,1)

            -- Box Type handling
            if boxEnabled then
                if settings.boxType == "Boxes" then
                    -- Main Box
                    esp.Box.Size = Vector2.new(boxWidth, boxHeight)
                    esp.Box.Position = Vector2.new(xPos, yPos)
                    esp.Box.Color = boxColor
                    esp.Box.Visible = true

                    esp.BoxOutline.Size = esp.Box.Size
                    esp.BoxOutline.Position = esp.Box.Position
                    esp.BoxOutline.Visible = true

                    -- Hide corner lines
                    for _, l in ipairs(esp.CornerLines) do l.Visible = false end
                elseif settings.boxType == "Corners" then
                    -- Hide main box
                    esp.Box.Visible, esp.BoxOutline.Visible = false, false

                    -- Draw corner lines
                    local cornerLen = boxWidth*0.25
                    local lines = esp.CornerLines
                    local cx, cy, w, h = xPos, yPos, boxWidth, boxHeight
                    local corners = {
                        {cx, cy, cx+cornerLen, cy},
                        {cx, cy, cx, cy+cornerLen},
                        {cx+w, cy, cx+w-cornerLen, cy},
                        {cx+w, cy, cx+w, cy+cornerLen},
                        {cx, cy+h, cx+cornerLen, cy+h},
                        {cx, cy+h, cx, cy+h-cornerLen},
                        {cx+w, cy+h, cx+w-cornerLen, cy+h},
                        {cx+w, cy+h, cx+w, cy+h-cornerLen}
                    }
                    for i, c in ipairs(corners) do
                        local line = lines[i]
                        line.From = Vector2.new(c[1], c[2])
                        line.To = Vector2.new(c[3], c[4])
                        line.Color = boxColor
                        line.Visible = true
                    end
                end
            else
                esp.Box.Visible, esp.BoxOutline.Visible = false, false
                for _, l in ipairs(esp.CornerLines) do l.Visible = false end
            end

            -- Tracer
            if flags["tbox"] then
                esp.TracerLine.From = screenCenter
                esp.TracerLine.To = Vector2.new(pos.X,pos.Y)
                esp.TracerLine.Color = tracerColor
                esp.TracerLine.Visible = true
            else
                esp.TracerLine.Visible = false
            end

            -- Health bar + number
            local healthPercent
-- === PERFECT HP BAR FOR YOUR BOX SYSTEM ===
if barEnabled then
    local hp = hum.Health
    local maxhp = hum.MaxHealth
    local perc = math.clamp(hp / maxhp, 0, 1)

    local lowColor  = flags["color hp low"]  or Color3.fromRGB(255,0,0)
    local fullColor = flags["color hp full"] or Color3.fromRGB(0,255,0)
    local hpColor = lowColor:Lerp(fullColor, perc)

    -- Ð¿Ð¾Ð·Ð¸Ñ†Ñ–Ñ HP BAR Ñ€Ñ–Ð²Ð½Ð¾ Ð¿Ð¾ Ð»Ñ–Ð²Ñ–Ð¹ ÑÑ‚Ð¾Ñ€Ð¾Ð½Ñ– Ñ‚Ð²Ð¾Ð³Ð¾ Ð±Ð¾ÐºÑÑƒ
    local barX = xPos - 5
    local barY = yPos

    -- outline
    esp.HealthBarOutline.Size = Vector2.new(3, boxHeight)
    esp.HealthBarOutline.Position = Vector2.new(barX - 1, barY - 1)
    esp.HealthBarOutline.Color = Color3.new(0,0,0)
    esp.HealthBarOutline.Thickness = 1
    esp.HealthBarOutline.Filled = false
    esp.HealthBarOutline.Visible = true

    -- fill
    local fillHeight = math.floor(boxHeight * perc)

    esp.HealthBar.Size = Vector2.new(1, fillHeight)
    esp.HealthBar.Position = Vector2.new(barX, barY + (boxHeight - fillHeight))
    esp.HealthBar.Color = hpColor
    esp.HealthBar.Filled = true
    esp.HealthBar.Visible = true

    -- % Ñ‚ÐµÐºÑÑ‚
    if numberEnabled then
        esp.HealthPercentText.Text = tostring(math.floor(perc * 100)) .. "%"
        esp.HealthPercentText.Color = hpColor
        esp.HealthPercentText.Position = Vector2.new(barX - 18, barY + (boxHeight - fillHeight) - 5)
        esp.HealthPercentText.Visible = true
    else
        esp.HealthPercentText.Visible = false
    end

else
    esp.HealthBar.Visible = false
    esp.HealthBarOutline.Visible = false
    esp.HealthPercentText.Visible = false
end

-- Name
local nameColor = flags["color name"] or Color3.new(1, 1, 1)

if flags["box name"] then
    esp.NameText.Text = settings.useDisplayName and player.DisplayName or player.Name
    esp.NameText.Position = Vector2.new(pos.X, yPos - 20)
    esp.NameText.Color = nameColor
    esp.NameText.Visible = true
else
    esp.NameText.Visible = false
end

            -- Distance
            if flags["box discr"] then
                local distText = settings.metric == "Meters" and string.format("%.0fm",distance) or string.format("%.0fs",distance)
                esp.DistanceText.Text = distText
                esp.DistanceText.Position = Vector2.new(pos.X, yPos+boxHeight+5)
                esp.DistanceText.Color = discrColor
                esp.DistanceText.Visible = true
            else
                esp.DistanceText.Visible = false
            end

            -- Equipped Item
            if flags["box item"] then
                local itemName = "Hands"
                if char:FindFirstChild("Equipped") then
                    local item = char.Equipped:FindFirstChildOfClass("Model")
                    if item then itemName = item.Name end
                end
                esp.ItemText.Text = "["..itemName.."]"
                esp.ItemText.Position = Vector2.new(pos.X, yPos+boxHeight+20)
                esp.ItemText.Color = itemColor
                esp.ItemText.Visible = true
            else
                esp.ItemText.Visible = false
            end

        else
            for _, v in pairs(esp) do
                if typeof(v) == "table" then
                    for _, l in ipairs(v) do l.Visible = false end
                else
                    v.Visible = false
                end
            end
        end
    end
end)

local LeftGroupBox = Tabs.Visuals:AddLeftGroupbox('Player Chams')

local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")

local lp = Players.LocalPlayer
local connections = {}

local Storage = Instance.new("Folder")
Storage.Name = "Highlight_Storage"
Storage.Parent = CoreGui

local FillColor = Color3.fromRGB(255, 255, 255)
local OutlineColor = Color3.fromRGB(255, 255, 255)
local FillTransparencySlider = 10
local OutlineTransparencySlider = 10
local ChamsEnabled = false

-- ðŸ”¹ ÐŸÐµÑ€ÐµÐ²Ð¾Ð´Ð¸Ð¼Ð¾ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð½Ñ ÑÐ»Ð°Ð¹Ð´ÐµÑ€Ñ–Ð² Ñƒ Ð¿Ñ€Ð¾Ð·Ð¾Ñ€Ñ–ÑÑ‚ÑŒ (0â€“1)
local function ToTransparency(val)
	return math.clamp(val / 20, 0, 1)
end

-- ðŸ”¹ ÐžÐ½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ Highlight
local function UpdateHighlight(h)
	h.FillColor = FillColor
	h.OutlineColor = OutlineColor
	h.FillTransparency = ToTransparency(FillTransparencySlider)
	h.OutlineTransparency = ToTransparency(OutlineTransparencySlider)
end

-- ðŸ”¹ Ð”Ð¾Ð´Ð°Ñ”Ð¼Ð¾ Highlight Ð³Ñ€Ð°Ð²Ñ†ÑŽ
local function Highlight(plr)
	if plr == lp then return end
	if Storage:FindFirstChild(plr.Name) then
		Storage[plr.Name]:Destroy()
	end

	local h = Instance.new("Highlight")
	h.Name = plr.Name
	h.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
	h.Enabled = ChamsEnabled
	h.Parent = Storage

	local function ApplyToCharacter(char)
		h.Adornee = char
		UpdateHighlight(h)
	end

	if plr.Character then
		ApplyToCharacter(plr.Character)
	end

	connections[plr] = plr.CharacterAdded:Connect(ApplyToCharacter)
end

-- ðŸ”¹ ÐžÐ±Ñ€Ð¾Ð±ÐºÐ° Ð³Ñ€Ð°Ð²Ñ†Ñ–Ð²
Players.PlayerAdded:Connect(Highlight)
for _, plr in ipairs(Players:GetPlayers()) do
	Highlight(plr)
end

Players.PlayerRemoving:Connect(function(plr)
	if Storage:FindFirstChild(plr.Name) then
		Storage[plr.Name]:Destroy()
	end
	if connections[plr] then
		connections[plr]:Disconnect()
		connections[plr] = nil
	end
end)

-- ðŸŸ£ ÐÐ¾Ð²Ñ– UI ÐµÐ»ÐµÐ¼ÐµÐ½Ñ‚Ð¸
LeftGroupBox:AddToggle('ChamsToggle', {
	Text = 'Player Chams',
	Default = false,
	Callback = function(Value)
		ChamsEnabled = Value
		for _, h in ipairs(Storage:GetChildren()) do
			h.Enabled = ChamsEnabled
		end
	end
})
:AddColorPicker('ChamsFillColor', {
	Default = FillColor,
	Title = 'Fill Color',
	Callback = function(Value)
		FillColor = Value
		for _, h in ipairs(Storage:GetChildren()) do
			h.FillColor = FillColor
		end
	end
})
:AddColorPicker('ChamsOutlineColor', {
	Default = OutlineColor,
	Title = 'Outline Color',
	Callback = function(Value)
		OutlineColor = Value
		for _, h in ipairs(Storage:GetChildren()) do
			h.OutlineColor = OutlineColor
		end
	end
})

LeftGroupBox:AddSlider('FillTransparencySlider', {
	Text = 'Fill Transparency',
	Min = 0,
	Max = 20,
	Default = FillTransparencySlider,
	Rounding = 1,
	Callback = function(Value)
		FillTransparencySlider = Value
		for _, h in ipairs(Storage:GetChildren()) do
			h.FillTransparency = ToTransparency(Value)
		end
	end
})

LeftGroupBox:AddSlider('OutlineTransparencySlider', {
	Text = 'Outline Transparency',
	Min = 0,
	Max = 20,
	Default = OutlineTransparencySlider,
	Rounding = 1,
	Callback = function(Value)
		OutlineTransparencySlider = Value
		for _, h in ipairs(Storage:GetChildren()) do
			h.OutlineTransparency = ToTransparency(Value)
		end
	end
})

local RightGroupBox = Tabs.Visuals:AddRightGroupbox('Lighting')

local Lighting = game:GetService("Lighting")
local RunService = game:GetService("RunService")

-- ðŸŸ£ NO FOG
local noFogConnection
RightGroupBox:AddToggle('NoFog_Toggle', {
	Text = 'No Fog',
	Default = false,
	Callback = function(Value)
		if Value then
			if noFogConnection then
				noFogConnection:Disconnect()
				noFogConnection = nil
			end
			noFogConnection = RunService.RenderStepped:Connect(function()
				Lighting.FogStart = 1e6
				Lighting.FogEnd = 1e6
				local atmosphere = Lighting:FindFirstChildOfClass("Atmosphere")
				if atmosphere then
					atmosphere.Density = 0
					atmosphere.Haze = 0
					atmosphere.Glare = 0
					atmosphere.Offset = 0
				end
			end)
		else
			if noFogConnection then
				noFogConnection:Disconnect()
				noFogConnection = nil
			end
			Lighting.FogStart = 0
			Lighting.FogEnd = 1000
		end
	end
})

-- ðŸŒ‘ NO SHADOWS
RightGroupBox:AddToggle('NoShadows_Toggle', {
	Text = 'No Shadows',
	Default = false,
	Callback = function(Value)
		Lighting.GlobalShadows = not Value
	end
})

-- ðŸŒ… CUSTOM AMBIENT
local AmbientEnabled = false
local AmbientColor = Color3.fromRGB(255, 255, 255)

local function UpdateAmbient()
	if AmbientEnabled then
		RunService:BindToRenderStep("CustomAmbient", 1, function()
			Lighting.Ambient = AmbientColor
		end)
	else
		RunService:UnbindFromRenderStep("CustomAmbient")
		Lighting.Ambient = Color3.new(1, 1, 1)
	end
end

RightGroupBox:AddToggle('CustomAmbient_Toggle', {
	Text = 'Custom World Ambient',
	Default = false,
	Callback = function(Value)
		AmbientEnabled = Value
		UpdateAmbient()
	end
})
:AddColorPicker('AmbientColor', {
	Default = AmbientColor,
	Title = 'Ambient Color',
	Callback = function(Value)
		AmbientColor = Value
		if AmbientEnabled then
			Lighting.Ambient = AmbientColor
		end
	end
})

-- âš™ï¸ CUSTOM TECHNOLOGY
local TechnologyEnabled = false
local SelectedTechnology = "Voxel"

RightGroupBox:AddToggle('Technology_Toggle', {
	Text = 'Custom Technology',
	Default = false,
	Callback = function(Value)
		TechnologyEnabled = Value
		if Value then
			pcall(function()
				Lighting.Technology = Enum.Technology[SelectedTechnology]
			end)
		else
			pcall(function()
				Lighting.Technology = Enum.Technology.Future
			end)
		end
	end
})

RightGroupBox:AddDropdown('Technology_Mode', {
	Text = 'Technology Mode',
	Default = 'Voxel',
	Values = {'Voxel', 'ShadowMap', 'Legacy', 'Compatibility', 'Future'},
	Callback = function(Value)
		SelectedTechnology = Value
		if TechnologyEnabled then
			pcall(function()
				Lighting.Technology = Enum.Technology[Value]
			end)
		end
	end
})

-- ðŸŒ‡ CUSTOM TIME
local timeConnection
local customTime = 12

RightGroupBox:AddToggle('CustomTime_Toggle', {
	Text = 'Custom Time',
	Default = false,
	Callback = function(Value)
		if Value then
			if timeConnection then
				timeConnection:Disconnect()
				timeConnection = nil
			end
			timeConnection = Lighting:GetPropertyChangedSignal("ClockTime"):Connect(function()
				Lighting.ClockTime = customTime
			end)
		else
			if timeConnection then
				timeConnection:Disconnect()
				timeConnection = nil
			end
		end
	end
})

RightGroupBox:AddSlider('CustomTime_Slider', {
	Text = 'Custom Time',
	Min = 0,
	Max = 24,
	Default = customTime,
	Rounding = 1,
	Callback = function(Value)
		customTime = Value
	end
})

local CustomSkyBox = Tabs.Visuals:AddRightGroupbox('Custom Sky Box')

local Lighting = game:GetService("Lighting")
flags = flags or {}

local function ClearSkybox()
	for _, child in pairs(Lighting:GetChildren()) do
		if child:IsA("Sky") then
			child:Destroy()
		end
	end
end

local function SetSkybox(name)
	ClearSkybox()

	local sky = Instance.new("Sky")
	sky.Name = name

	if name == "Galaxy" then
		sky.SkyboxBk = "http://www.roblox.com/asset/?id=149397692"
		sky.SkyboxDn = "http://www.roblox.com/asset/?id=149397686"
		sky.SkyboxFt = "http://www.roblox.com/asset/?id=149397697"
		sky.SkyboxLf = "http://www.roblox.com/asset/?id=149397684"
		sky.SkyboxRt = "http://www.roblox.com/asset/?id=149397688"
		sky.SkyboxUp = "http://www.roblox.com/asset/?id=149397702"
	elseif name == "Galaxy 2" then
		sky.SkyboxBk = "http://www.roblox.com/asset/?id=155441936"
		sky.SkyboxDn = "http://www.roblox.com/asset/?id=155441802"
		sky.SkyboxFt = "http://www.roblox.com/asset/?id=155441818"
		sky.SkyboxLf = "http://www.roblox.com/asset/?id=155441777"
		sky.SkyboxRt = "http://www.roblox.com/asset/?id=155441874"
		sky.SkyboxUp = "http://www.roblox.com/asset/?id=155441905"
	elseif name == "Galaxy 3" then
		sky.SkyboxBk = "rbxassetid://135908594667929"
		sky.SkyboxDn = "rbxassetid://139584143501514"
		sky.SkyboxFt = "rbxassetid://92947876187368"
		sky.SkyboxLf = "rbxassetid://72493016739936"
		sky.SkyboxRt = "rbxassetid://81731245279712"
		sky.SkyboxUp = "rbxassetid://88174897344210"
	elseif name == "Saturne" then
		sky.SkyboxBk = "rbxassetid://1898724755"
		sky.SkyboxDn = "rbxassetid://1898727189"
		sky.SkyboxFt = "rbxassetid://1898722814"
		sky.SkyboxLf = "rbxassetid://1898729298"
		sky.SkyboxRt = "rbxassetid://1898741025"
		sky.SkyboxUp = "rbxassetid://1898736761"
	elseif name == "Neptune" then
		sky.SkyboxBk = "rbxassetid://218955819"
		sky.SkyboxDn = "rbxassetid://218953419"
		sky.SkyboxFt = "rbxassetid://218954524"
		sky.SkyboxLf = "rbxassetid://218958493"
		sky.SkyboxRt = "rbxassetid://218957134"
		sky.SkyboxUp = "rbxassetid://218950090"
	elseif name == "Redshift" then
		sky.SkyboxBk = "rbxassetid://401664839"
		sky.SkyboxDn = "rbxassetid://401664862"
		sky.SkyboxFt = "rbxassetid://401664960"
		sky.SkyboxLf = "rbxassetid://401664881"
		sky.SkyboxRt = "rbxassetid://401664901"
		sky.SkyboxUp = "rbxassetid://401664936"
	elseif name == "Pink Daylights" then
		sky.SkyboxBk = "rbxassetid://11555017034"
		sky.SkyboxDn = "rbxassetid://11555013415"
		sky.SkyboxFt = "rbxassetid://11555010145"
		sky.SkyboxLf = "rbxassetid://11555006545"
		sky.SkyboxRt = "rbxassetid://11555000712"
		sky.SkyboxUp = "rbxassetid://11554996247"
	elseif name == "Purple Night" then
		sky.SkyboxBk = "rbxassetid://17279854976"
		sky.SkyboxDn = "rbxassetid://17279856318"
		sky.SkyboxFt = "rbxassetid://17279858447"
		sky.SkyboxLf = "rbxassetid://17279860360"
		sky.SkyboxRt = "rbxassetid://17279862234"
		sky.SkyboxUp = "rbxassetid://17279864507"
	elseif name == "Gray Night" then
		sky.SkyboxBk = "rbxassetid://1618912481"
		sky.SkyboxDn = "rbxassetid://1618913943"
		sky.SkyboxFt = "rbxassetid://1618913244"
		sky.SkyboxLf = "rbxassetid://1618912849"
		sky.SkyboxRt = "rbxassetid://1618911568"
		sky.SkyboxUp = "rbxassetid://1618913654"
	elseif name == "Anime Sky" then
		sky.SkyboxBk = "rbxassetid://18351376859"
		sky.SkyboxDn = "rbxassetid://18351374919"
		sky.SkyboxFt = "rbxassetid://18351376800"
		sky.SkyboxLf = "rbxassetid://18351376469"
		sky.SkyboxRt = "rbxassetid://18351376457"
		sky.SkyboxUp = "rbxassetid://18351377189"
	else
		warn("Unknown skybox:", tostring(name))
		return
	end

	sky.Parent = Lighting
end

flags.CustomSkyEnabled = false
flags.SelectedSky = "Galaxy"

CustomSkyBox:AddToggle('CustomSky_Toggle', {
	Text = 'Custom Sky',
	Default = false,
	Callback = function(Value)
		flags.CustomSkyEnabled = Value
		if flags.CustomSkyEnabled then
			SetSkybox(flags.SelectedSky)
		else
			ClearSkybox()
		end
	end
})

CustomSkyBox:AddDropdown('SkyboxSelector', {
	Text = 'Skybox Selector',
	Default = 'Galaxy',
	Values = {
		'Galaxy', 'Galaxy 2', 'Galaxy 3',
		'Saturne', 'Neptune', 'Redshift',
		'Pink Daylights', 'Purple Night',
		'Gray Night', 'Anime Sky'
	},
	Callback = function(Value)
		flags.SelectedSky = Value
		if flags.CustomSkyEnabled then
			SetSkybox(flags.SelectedSky)
		end
	end
})

local LocalPlayer = Tabs.Visuals:AddRightGroupbox('Local Player')

local RunService = game:GetService("RunService")

local ArmChams_Enabled = false
local WeaponChams_Enabled = false
local ArmMaterial = "Plastic"
local WeaponMaterial = "Plastic"
local ArmChams_Color = Color3.fromRGB(50, 50, 50)
local WeaponChams_Color = Color3.fromRGB(50, 50, 50)

-- ðŸ”¹ ÐšÐ¾Ð»Ñ–Ñ€ â†’ VertexColor
local function ColorToVertex(color)
    return Vector3.new(color.R, color.G, color.B)
end

-- ===============================================
-- ðŸŸ¦ ARM CHAMS UI (FLUENT RENEWED)
-- ===============================================

LocalPlayer:AddToggle("ArmChamsToggle", {
    Text = "Arm Chams",
    Default = false,
    Tooltip = "Enable Arm Chams",
    Callback = function(v)
        ArmChams_Enabled = v
    end
})
:AddColorPicker("ArmChamsColorPicker", {
    Default = ArmChams_Color,
    Title = "Arm Color",
    Transparency = 0,
    Callback = function(c)
        ArmChams_Color = c
    end
})

LocalPlayer:AddDropdown("ArmMaterialDropdown", {
    Text = "Arm Material",
    Default = ArmMaterial,
    Values = {"Plastic", "ForceField", "Wood", "Grass"},
    Callback = function(v)
        ArmMaterial = v
    end
})

-- ===============================================
-- ðŸ”« WEAPON CHAMS UI (FLUENT RENEWED)
-- ===============================================

LocalPlayer:AddToggle("WeaponChamsToggle", {
    Text = "Weapon Chams",
    Default = false,
    Tooltip = "Enable Weapon Chams",
    Callback = function(v)
        WeaponChams_Enabled = v
    end
})
:AddColorPicker("WeaponChamsColorPicker", {
    Default = WeaponChams_Color,
    Title = "Weapon Color",
    Transparency = 0,
    Callback = function(c)
        WeaponChams_Color = c
    end
})

LocalPlayer:AddDropdown("WeaponMaterialDropdown", {
    Text = "Weapon Material",
    Default = WeaponMaterial,
    Values = {"Plastic", "ForceField", "Wood", "Grass"},
    Callback = function(v)
        WeaponMaterial = v
    end
})

-- ===============================================
-- ðŸ”¥ ÐžÐ¡ÐÐžÐ’ÐÐ Ð¤Ð£ÐÐšÐ¦Ð†Ð¯ CHAMS
-- ===============================================

local function ApplyFluentChams()
    local armsFolder = workspace.CurrentCamera:FindFirstChild("Arms")
    if not armsFolder then return end

    for _, v in pairs(armsFolder:GetDescendants()) do
        if v:IsA("BasePart") or v:IsA("MeshPart") then

            local isArm = (v.Name == "Left Arm" or v.Name == "Right Arm")
            local isWeapon = not isArm

            -- ðŸ¦¾ ARM CHAMS
            if ArmChams_Enabled and isArm then
                v.Material = Enum.Material[ArmMaterial]
                v.Color = ArmChams_Color

                local mesh = v:FindFirstChildOfClass("SpecialMesh")
                if mesh then
                    mesh.VertexColor = ColorToVertex(ArmChams_Color)
                end
            end

            -- ðŸ”« WEAPON CHAMS
            if WeaponChams_Enabled and isWeapon then
                v.Material = Enum.Material[WeaponMaterial]
                v.Color = WeaponChams_Color

                local mesh = v:FindFirstChildOfClass("SpecialMesh")
                if mesh then
                    mesh.VertexColor = ColorToVertex(WeaponChams_Color)
                end
            end
        end
    end
end

-- ðŸ” ÐŸÐžÐ¡Ð¢Ð†Ð™ÐÐ• ÐžÐÐžÐ’Ð›Ð•ÐÐÐ¯
RunService.Heartbeat:Connect(ApplyFluentChams)

local CustomCrosshair = Tabs.Visuals:AddRightGroupbox('Custom Crosshair')

-- ðŸ§  Ð¡ÐµÑ€Ð²Ñ–ÑÐ¸
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local lp = Players.LocalPlayer

-- âš™ï¸ Ð—Ð¼Ñ–Ð½Ð½Ñ–
local crosshairEnabled = false
local spinningEnabled = false
local outlineEnabled = false
local rotationSpeed = 120
local color = Color3.fromRGB(255, 255, 255)
local size = 12
local thickness = 2
local orientation = 0

-- ðŸªŸ GUI ÑÑ‚Ð²Ð¾Ñ€ÐµÐ½Ð½Ñ
local gui = Instance.new("ScreenGui")
gui.Name = "RotatingCrosshair"
gui.ResetOnSpawn = false
gui.IgnoreGuiInset = true
gui.Parent = lp:WaitForChild("PlayerGui")

-- Ð¦ÐµÐ½Ñ‚Ñ€Ð°Ð»ÑŒÐ½Ð° Ð³Ñ€ÑƒÐ¿Ð° Ð´Ð»Ñ Ð°Ð²Ñ‚Ð¾Ð¿Ð¾Ð·Ð¸Ñ†Ñ–ÑŽÐ²Ð°Ð½Ð½Ñ
local group = Instance.new("Frame")
group.AnchorPoint = Vector2.new(0.5, 0.5)
group.Position = UDim2.new(0.5, 0, 0.5, 0)
group.Size = UDim2.new(0, 0, 0, 0)
group.BackgroundTransparency = 1
group.BorderSizePixel = 0
group.Parent = gui

-- Ð¦ÐµÐ½Ñ‚Ñ€
local center = Instance.new("Frame")
center.AnchorPoint = Vector2.new(0.5, 0.5)
center.Size = UDim2.new(0, thickness, 0, thickness)
center.BackgroundColor3 = color
center.BorderSizePixel = 0
center.Visible = false
center.Parent = group

-- Ð“Ð¾Ñ€Ð¸Ð·Ð¾Ð½Ñ‚Ð°Ð»ÑŒÐ½Ð° Ð»Ñ–Ð½Ñ–Ñ
local horiz = Instance.new("Frame")
horiz.AnchorPoint = Vector2.new(0.5, 0.5)
horiz.Size = UDim2.new(0, size, 0, thickness)
horiz.BackgroundColor3 = color
horiz.BorderSizePixel = 0
horiz.Visible = false
horiz.Parent = group

-- Ð’ÐµÑ€Ñ‚Ð¸ÐºÐ°Ð»ÑŒÐ½Ð° Ð»Ñ–Ð½Ñ–Ñ
local vert = Instance.new("Frame")
vert.AnchorPoint = Vector2.new(0.5, 0.5)
vert.Size = UDim2.new(0, thickness, 0, size)
vert.BackgroundColor3 = color
vert.BorderSizePixel = 0
vert.Visible = false
vert.Parent = group

-- Outline (Ñ‡Ð¾Ñ€Ð½Ð° Ð¾Ð±Ð²Ð¾Ð´ÐºÐ°)
local outline = Instance.new("UIStroke")
outline.Thickness = 1
outline.Color = Color3.new(0, 0, 0)
outline.Enabled = false
outline.Parent = horiz

local outline2 = outline:Clone()
outline2.Parent = vert

-- ðŸ”„ ÐžÐ½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ Ð²Ð¸Ð³Ð»ÑÐ´Ñƒ
local function UpdateCrosshair()
	horiz.BackgroundColor3 = color
	vert.BackgroundColor3 = color
	center.BackgroundColor3 = color
	horiz.Size = UDim2.new(0, size, 0, thickness)
	vert.Size = UDim2.new(0, thickness, 0, size)
	horiz.Visible = crosshairEnabled
	vert.Visible = crosshairEnabled
	center.Visible = crosshairEnabled
	outline.Enabled = outlineEnabled
	outline2.Enabled = outlineEnabled
end

-- ðŸŒ€ ÐžÐ±ÐµÑ€Ñ‚Ð°Ð½Ð½Ñ
local angle = 0
RunService.RenderStepped:Connect(function(dt)
	if spinningEnabled and crosshairEnabled then
		angle += rotationSpeed * dt
		horiz.Rotation = angle + orientation
		vert.Rotation = angle + orientation
	elseif crosshairEnabled then
		horiz.Rotation = orientation
		vert.Rotation = orientation
	end
end)

-- ðŸ§© Fluent UI Ñ–Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ñ–Ñ (RightGroupBox)
CustomCrosshair:AddToggle('Crosshair_Toggle', {
	Text = 'Crosshair',
	Default = false,
	Callback = function(Value)
		crosshairEnabled = Value
		UpdateCrosshair()
	end
})
:AddColorPicker('Crosshair_Color', {
	Default = color,
	Title = 'Crosshair Color',
	Callback = function(Value)
		color = Value
		UpdateCrosshair()
	end
})

CustomCrosshair:AddToggle('CrosshairSpin_Toggle', {
	Text = 'Spinning Crosshair',
	Default = false,
	Callback = function(Value)
		spinningEnabled = Value
	end
})

CustomCrosshair:AddToggle('CrosshairOutline_Toggle', {
	Text = 'Outline',
	Default = false,
	Callback = function(Value)
		outlineEnabled = Value
		UpdateCrosshair()
	end
})

CustomCrosshair:AddSlider('Crosshair_Size', {
	Text = 'Crosshair Size',
	Min = 8,
	Max = 20,
	Default = size,
	Rounding = 1,
	Callback = function(Value)
		size = Value
		UpdateCrosshair()
	end
})

CustomCrosshair:AddSlider('Crosshair_Thickness', {
	Text = 'Crosshair Thickness',
	Min = 1,
	Max = 5,
	Default = thickness,
	Rounding = 1,
	Callback = function(Value)
		thickness = Value
		UpdateCrosshair()
	end
})

Library:SetWatermarkVisibility(true)

-- Example of dynamically-updating watermark with common traits (fps and ping)
local FrameTimer = tick()
local FrameCounter = 0;
local FPS = 120;

local WatermarkConnection = game:GetService('RunService').RenderStepped:Connect(function()
    FrameCounter += 1;

    if (tick() - FrameTimer) >= 1 then
        FPS = FrameCounter;
        FrameTimer = tick();
        FrameCounter = 0;
    end;

    Library:SetWatermark(('NexusVision | %s fps | %s ms'):format(
        math.floor(FPS),
        math.floor(game:GetService('Stats').Network.ServerStatsItem['Data Ping']:GetValue())
    ));
end);

Library.KeybindFrame.Visible = true; -- todo: add a function for this

Library:OnUnload(function()
    WatermarkConnection:Disconnect()

    print('Unloaded!')
    Library.Unloaded = true
end)

local MenuGroup = Tabs['UI Settings']:AddLeftGroupbox('Menu')

MenuGroup:AddButton('Unload', function() Library:Unload() end)
MenuGroup:AddLabel('Menu bind'):AddKeyPicker('MenuKeybind', { Default = 'End', NoUI = true, Text = 'Menu keybind' })

Library.ToggleKeybind = Options.MenuKeybind -- Allows you to have a custom keybind for the menu

ThemeManager:SetLibrary(Library)
SaveManager:SetLibrary(Library)

SaveManager:IgnoreThemeSettings()

SaveManager:SetIgnoreIndexes({ 'MenuKeybind' })

ThemeManager:SetFolder('MyScriptHub')
SaveManager:SetFolder('MyScriptHub/specific-game')

SaveManager:BuildConfigSection(Tabs['UI Settings'])

ThemeManager:ApplyToTab(Tabs['UI Settings'])

SaveManager:LoadAutoloadConfig()
